(function(){window.oAuth={debug:!1};var n=function(){};oAuth.sender=null;oAuth.google={};oAuth.google.init=function(t,i){for(var r,u,e=t.split(","),f=0;f<e.length;f++)containerId=e[f],n("google.init:"+containerId),r=document.getElementById(containerId),r||(r=document.createElement("div"),r.id=containerId,document.body.appendChild(r)),i?r.onclick=function(){oAuth.sender=r;oAuth.google.login()}:(u=document.createElement("a"),u.id="btn-google-login",u.className="btn-oauth-login google",u.href="javascript:void(0);",u.innerHTML="Bằng Google",r.appendChild(u),u.onclick=function(){oAuth.sender=r;oAuth.google.login()});(function(){var n=document.createElement("script"),t;n.type="text/javascript";n.async=!0;n.src="https://apis.google.com/js/client.js?onload=googleApiOnLoad";t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(n,t)})();window.googleApiOnLoad=function(){n("google.apiOnLoad");window.googleLoginCallback=function(n){window.oAuth.google.loginCallback(n)}}};oAuth.google.loginParams={clientid:"736278746092-n6hrdbskg7hivo7rr4k0j931g93qs27m.apps.googleusercontent.com",cookiepolicy:"single_host_origin",callback:"googleLoginCallback",approvalprompt:"force",scope:"https://www.googleapis.com/auth/plus.login"};oAuth.google.login=function(){n("google.login");gapi&&gapi.auth.signIn(this.loginParams)};oAuth.google.loginCallback=function(t){n(t);gapi&&(gapi.client.setApiKey("AIzaSyB40lxBANJinIapy1aVSfFcbNzZ7jQvAK8"),n("google.loginCallback"),n(t),t.status.signed_in===!0&&gapi.client.load("plus","v1",function(){n("gapi.client.load('plus', 'v1')");gapi.client.plus.people.get({userId:"me"}).execute(function(t){var r,u;if(n("gapi.client.plus.people.get({ 'userId': 'me' })"),n(t),r="",t.emails)for(i=0;i<t.emails.length;i++)t.emails[i].type=="account"&&(r=t.emails[i].value);u={network:"google",id:t.id,name:t.displayName,image:t.image.url,url:t.url,email:r};n(u);window.oAuth.login(u)})}))};oAuth.facebook={};oAuth.facebook.init=function(t,i){function o(t){if(n("statusChangeCallback"),n(t),t.status==="connected"){s();var i=t.authResponse}else t.status==="not_authorized"}function s(){n("Welcome!  Fetching your information.... ");FB.api("/me",function(t){n(t);var i={network:"facebook",id:t.id,name:t.name,image:"",url:t.link,email:t.email};n(i);window.oAuth.login(i)})}for(var r,f,e=t.split(","),u=0;u<e.length;u++)containerId=e[u],n("facebook.init:"+containerId),r=document.getElementById(containerId),r||(r=document.createElement("div"),r.id=containerId,document.body.appendChild(r)),i?r.onclick=function(){oAuth.sender=this;FB.login(function(n){n.authResponse?o(n):console.log("User cancelled login or did not fully authorize.")},{scope:"public_profile,email"})}:(f=document.createElement("div"),f.innerHTML='<fb:login-button scope="public_profile,email" onlogin="checkLoginState();" size="xlarge">Bằng Facebook<\/fb:login-button>',r.onmousemove=function(){oAuth.sender=this},r.appendChild(f));window.checkLoginState=function(){n("checkLoginState");FB.getLoginStatus(function(n){o(n)})};window.fbAsyncInit=function(){FB.init({appId:"506058232811448",xfbml:!0,version:"v2.8"});window.My_fbAsyncInit&&window.My_fbAsyncInit()},function(n,t,i){var r,u=n.getElementsByTagName(t)[0];n.getElementById(i)||(r=n.createElement(t),r.id=i,r.src="//connect.facebook.net/vi_VN/sdk.js#xfbml=1&version=v2.3",u.parentNode.insertBefore(r,u))}(document,"script","facebook-jssdk")};oAuth.facebook.login=function(){};oAuth.login=function(){},function(){n("script loaded")}()})();
function oauth_login(n,t){function i(t,i,r){($(document).trigger("login.load"),r&&(console.log([t,i]),$(r).trigger("login.ok",[t,i]),$(r).data("prevent")==1))||(typeof n=="undefined"||n==null?location.reload():typeof n=="function"?n(t,i,r):location.href.replace(n))}if(window._oauth_login_defined_)return!1;window._oauth_login_defined_=!0;oAuth.debug=!0;oAuth.login=function(r){var u,f;r.mod="ajax";r.cmd="auto";r.code=t;u=r;(typeof u.email=="undefined"||u.email==null)&&(u.email="",r.email="");f=$(oAuth.sender);$.post("/account/login.aspx",u,function(t){var o,e;if(t!=null&&t!="")if(o=t.split("|"),o[0]==1)i(r,t,oAuth.sender);else if(o[0]==0){var c="",h="",l="",s=!1,e='<div class="sig-box">';if(o.length>1?(c=o[4],h=o[3],l=o[2],e+='<div class="msg exist">Chúng tôi tìm thấy một tài khoản có Email giống với E-mail trong tài khoản <b>'+u.network+"<\/b> của bạn. Bạn có muốn liên kết các tài khoản với nhau không?<\/div>",s=!0):(c=u.name,h=u.email,l=u.email,e='<div class="sig-box"><div class="msg not-exist">Chúng tôi không tìm thấy tài khoản nào tương ứng với tài khoản <b>'+u.network+"<\/b> của bạn. Bạn có muốn tự động tạo mới tài khoản với các thông tin tương ứng như sau không?<\/div>",s=!1),e+='<div class="info"><ul>',e+='<li class="name"><span class="label">Tên:<\/span><span class="value">'+c+"<\/span><\/li>",h!=""&&(e+='<li class="email"><span class="label">Email:<\/span><span class="value">'+h+"<\/span><\/li>"),s&&(e+='<li class="user"><span class="label">Tên đăng nhập:<\/span><span class="value"><input type="text" class="txtBox" id="sig-user" value="'+l+'" name="sig-user" placeholder="Tên đăng nhập"/><\/span><\/li>',e+='<li class="password"><span class="label">Mật khẩu:<\/span><span class="value"><input type="password"  class="txtBox"  id="sig-password" name="sig-password" placeholder="Mật khẩu"/><\/span><div class="tips">Nhập mật khẩu của tài khoản cũ để chúng tôi liên kết với tải khoản <b>'+u.network+"<\/b> của bạn<\/div><\/li>"),e+="<\/ul><\/div>",e+=s?'<div class="buttons"><input type="button" value="Liên kết tài khoản" id="sig-login" name="sig-login" class="btn btn-primary"/><input type="button" value="Tự động đăng nhập" id="sig-login-auto" name="sig-login-auto" class="btn"/><\/div>':'<div class="buttons"><input type="button" value="Thoát" id="sig-login-auto-cancel" name="sig-login-auto-cancel" class="btn"/><input type="button" value="Đăng nhập" id="sig-login-auto" name="sig-login-auto" class="btn btn-primary"/><\/div>',e+="<\/div>",f.data("mod")=="auto"){$.post("/account/login.aspx",u,function(n){n==1?i(r,t,oAuth.sender):alert("Lỗi trong quá trình xử lý, hãy thử lại")});return}$("#ig-social-pad").html(e);$("#loginPad").hide();$("#ig-social-pad").show();$("html,body").animate({scrollTop:$("#ig-social-pad").offset().top},"slow");$("#sig-login-auto").click(function(){r.cmd="auto";$.post("/account/login.aspx",r,function(n){n==1?i(r,t,oAuth.sender):alert("Lỗi trong quá trình xử lý, hãy thử lại")})});s||(window._autoLoginCountDownID=window.setInterval(function(){var i=$("#sig-login-auto"),t=i.data("dem")||6;t=t-1;i.data("dem",t);i.val("Đăng nhập ("+t+")");t<=0&&(n="/account/",i.trigger("click"),window.clearInterval(window._autoLoginCountDownID))},1e3),$("#sig-login-auto-cancel").click(function(){window._autoLoginCountDownID&&window.clearInterval(window._autoLoginCountDownID);window.top.location.reload()}));$("#sig-login").click(function(n){r.cmd="merge";var u=$.trim($("#sig-user").val()),f=$.trim($("#sig-password").val());if(u==""||f=="")return alert("Hãy nhập tên đăng nhập và mật khẩu để tiến hành liên kết"),n.preventDefault,!1;r.user=u;r.password=f;$.post("/account/login.aspx",r,function(n){n==1?i(r,t,oAuth.sender):n==-1?alert("Thông tin đăng nhập sai, hãy thử lại"):alert("Lỗi trong quá trình xử lý, hãy thử lại")})})}})};oAuth.facebookButtons=["facebook-login","facebook-login-hd","facebook-login-rg","facebook-login-review"];oAuth.googleButtons=["google-login","google-login-hd","google-login-rg","google-login-review"];for(var r=0;r<oAuth.facebookButtons.length;r++)$("#"+oAuth.facebookButtons[r]).hide();oAuth.google.init(oAuth.googleButtons.join(","),!0)}
